var MAX_DATE=26571,LANG=$("html").attr("lang"),REASONS={expiration:{jp:"任期満了に伴う総選挙",en:"Due to expiration"},dissolution:{jp:"解散に伴う総選挙",en:"Due to dissolution"},censure:{jp:"不信任案の可決等に伴う解散",en:"Due to non-confidence"},expire:{jp:"任期満了に伴う自動解散",en:"Automatic dissolution"}};function map(value,low1,high1,low2,high2){var ret;return low2+(high2-low2)*(value-low1)/(high1-low1)}function addYear(date,string){var y,html='<div class="year" style="top:'+map(date,0,MAX_DATE,0,98)+'%"><div class="string">'+string+'</div><div class="line"></div></div>';$("#years").append(html)}function translatePeriod(period){return"en"===LANG&&(period=(period=period.replace("年"," years<br>")).replace("ヶ月"," months")),period}function translateCountry(name){return"jp"===LANG&&(name=(name=(name=(name=(name=(name=(name=name.replace("US","アメリカ")).replace("Germany","ドイツ")).replace("France","フランス")).replace("Italy","イタリア")).replace("UK","イギリス")).replace("Canada","カナダ")).replace("Japan","日本")),name}function translateDisnumber(disnum){return"jp"===LANG?'<div class="disnumber">解散回数: <br><span class="disnumber-inner">'+disnum+"</span> 回</div>":'<div class="disnumber">Dissolution: <br><span class="disnumber-inner">'+disnum+"</span> times</div>"}$(function(){$("#cover").is(":visible")&&$("#cover").fadeOut(),$(document).on("click touchend",".more",function(e){e.preventDefault(),$(this).hide("fast"),$("#description-block").find(".detail").show("fast")}),$(document).on("click touchend",".less",function(e){e.preventDefault(),$("#description-block").find(".detail").hide("fast"),$(".more").show("fast")}),$(document).on("click touchend",function(e){$(e.target).closest(".election").length||($(".hovered").removeClass("hovered"),$(".tooltip").remove())}),$(document).on("mouseover touchend",".election",function(){$(".hovered").removeClass("hovered"),$(this).addClass("hovered"),$(".tooltip").remove();var explanation=REASONS.expiration[LANG];$(this).hasClass("dissolution")?(explanation=REASONS.dissolution[LANG],$(this).hasClass("censure")&&(explanation=REASONS.censure[LANG])):$(this).hasClass("expire")&&(explanation=REASONS.expire[LANG]);var tooltip='<div class="tooltip">'+$(this).attr("date")+"<br>"+explanation+"</div>";$(this).append(tooltip)}),$.getJSON("data.json",function(json){for(var i=0;i<json.length;i++){var country=json[i],name=country.name,disnum=country.num,period=translatePeriod(country.period),data=country.data,html='<div class="country country'+i+'"><div class="cname">'+translateCountry(name)+'</div><div class="flag" style="background-image:url(img/flag_'+name+'.png)"></div>'+translateDisnumber(disnum)+'<div class="avgperiod">'+period+'</div><div class="timeline"><div class="bone"></div></div></div>';$("#countries").append(html);for(var j=0;j<data.length;j++){var value=data[j],y=map(value[0],0,MAX_DATE,0,100),dclass="";1===value[1]&&(dclass+=" dissolution"),"C"===value[3]&&(dclass+=" censure"),"E"===value[3]&&(dclass+=" expire");var e='<div class="election'+dclass+'" date="'+value[2]+'" style="top:'+y+'%;"><div class="inner"></div></div>';$(".timeline:last").append(e)}}}),addYear(1826,"1950"),addYear(5478,"1960"),addYear(9131,"1970"),addYear(12783,"1980"),addYear(16436,"1990"),addYear(20088,"2000"),addYear(23741,"2010")});