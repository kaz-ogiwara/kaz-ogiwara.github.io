function addCommas(num){return String(num).replace(/(\d)(?=(\d\d\d)+(?!\d))/g,"$1,")}function getPopupContent(station){var ret;return'<div class="name">JR '+station[0]+'駅</div><div class="label">１日平均乗車人員数</div><div class="right">'+addCommas(station[1])+"人</div>"}var kMap=L.map("map").setView([35.679,139.732],10),kMarkers=[];L.tileLayer("http://{s}.tiles.wmflabs.org/bw-mapnik/{z}/{x}/{y}.png",{attribution:'&copy; <a href="http://www.openstreetmap.org/copyright" target="_blank">OpenStreetMap</a>',maxZoom:16,minZoom:6}).addTo(kMap),$.ajaxSetup({cache:!1}),$.getJSON("data.json",function(data){$.each(data,function(i,station){let num=station[1],kType="k1";1e4<num&&(kType="k2"),5e4<num&&(kType="k3"),1e5<num&&(kType="k4"),2e5<num&&(kType="k5"),kMarkers[i]=L.marker([station[2],station[3]],{icon:L.divIcon({className:"location "+kType})}).addTo(kMap).bindPopup(getPopupContent(station))})});